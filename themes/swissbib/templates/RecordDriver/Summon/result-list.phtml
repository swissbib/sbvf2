<?php
	/** @var	Swissbib\RecordDriver\Summon		$resultItem  */
$resultItem		= $this->driver;
	/** @var	VuFind\View\Helper\Root\Record		$viewRecord  */
$viewRecord		= $this->record($this->driver);

$favoriteLink	= $this->recordLink()->getActionUrl($this->driver, 'Save');

$hasFullText	= $resultItem->hasFulltext();
$detailLink		= $this->recordLink()->getUrl($resultItem);
$thumbnail		= $this->escapeHtml($viewRecord->getThumbnail('small'));
$thumbnailSrc	= $thumbnail ? $thumbnail : $this->url('cover-unavailable');

$title			= $this->escapeHtml($this->shorttitleSummon($this->mainTitle($resultItem->getShortTitle())));
$edition		= $resultItem->getEdition();
$publicationDate= $this->publicationDateSummon($resultItem->getPublicationDates());

$link360        = $resultItem->getLink();
$openURL		= $resultItem->getOpenURL();
$linkSFX        = $this->openUrl($openURL);
$linkSFX_param  = 'title = "' .$this->transEsc('articles.linkSFX') .'" target="_blank"';
$linkSFX        = str_replace("<a ", "<a $linkSFX_param ", $linkSFX);

$CONTAINER      = $resultItem->getContainerTitle();
if ($CONTAINER) {
    $CONTAINER .= '. - ' .$resultItem->getContainerReference();
}

?>
<tr>
	<!-- Column 1: Index -->
	<td class="small center nodivider"><?=$this->recordIndex?></td>
	<!-- Column 2: Memo list -->
	<td class="nodivider">
		<a href="<?=$favoriteLink?>" class="icon_notepad_add" title="<?=$this->transEsc('memorizelistadd')?>"></a>
	</td>
	<!-- Column 3: Teaser-image / Thumbnail -->
	<td class="right nodivider">
		<a href="<?=$detailLink?>" title="<?=$title?>">
			<img src="<?=$thumbnailSrc?>" alt="<?=$title?>" class="dropshadow"/>
		</a>
	</td>
	<!-- Column 4/5 : Title and author details -->
	<td>
		<h3><a href="<?=$detailLink?>" title="<?=$title?>" class="color singleLink"><?=$title?></a></h3>
		<!-- meta -->
		<div class="meta">
			<h6><?=$this->transEsc('Author')?>:</h6>
			<span><?= $resultItem->getAuthor() ?></span><br/>
		</div>
		<?php if($CONTAINER): ?>
			<div class="meta">
				<h6><?=$this->transEsc('note_773')?>:</h6>
				<span><?=$this->escapeHtml($CONTAINER)?></span>
			</div>
		<?php endif; ?>
		<div class="meta">
			<h6><?=$this->transEsc('Year')?>:</h6>
			<span><?=$this->escapeHtml($publicationDate)?></span>
			<?php if($edition): ?>
				<h6><?=$this->transEsc('Edition')?>:</h6>
				<span><?=$this->escapeHtml($edition)?></span>
			<?php endif; ?>
		</div>
		<!-- format -->
		<div class="format">
			<?=$viewRecord->getFormatList()?>
		</div>
	</td>
	<td colspan="2">
		<span>
			<a title="<?= $this->transEsc('articles.link360') ?>" class="linkbutton primary icon_link_primary"
				target="_blank" href="<?= $link360 ?>">
			<span>get&#160;it</span></a>
		</span>
		<br /><br />
		<span><?= $linkSFX ?></span>
	</td>
</tr>
